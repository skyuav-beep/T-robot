# 실행 가능한 산출물 (Spec v0.7 기준)

> 기반 문서: `docs/specs/2025-10-02-spec-v0.7.md` (섹션 번호 참조).

## 스프린트 맵 요약
- **스프린트-0 (베이스라인)**: D-INF-01, D-INF-02, D-INF-03, D-INF-04, D-INF-05, D-DOC-01
- **스프린트-1 (핵심 유스케이스)**: D-API-01, D-API-02, D-API-03, D-API-04, D-API-05, D-STR-01, D-DATA-01
- **스프린트-2 (봇 런타임 베타)**: D-BOT-01, D-BOT-02, D-BOT-03, D-BOT-04, D-BOT-05, D-MON-01, D-MON-02, D-MON-03, D-CURVE-01, D-CURVE-02
- **품질/운영 상시**: D-QA-01, D-QA-02, D-QA-03, D-QA-04, D-OPS-01, D-OPS-02

---

## 1. 베이스라인 & 환경
- **D-INF-01 Monorepo 스캐폴드**
  - 주요 작업: `apps/gw`, `apps/bots`, `packages/shared` 기본 디렉터리, `pnpm-workspace.yaml`, 루트 `package.json`, `tsconfig.base.json` 작성.
  - 완료 조건: 섹션 19.1 구조와 일치하는 프로젝트 뼈대, 빌드 스크립트(`pnpm dev`, `pnpm lint` 등) 연결.
  - 참조: 섹션 19.1, 19.2.
- **D-INF-02 환경 변수 템플릿 및 시크릿 처리**
  - 주요 작업: `.env.example`, `.env.dev` 샘플, KMS/암호화 키 변수 정의, 민감정보 미커밋 가드.
  - 완료 조건: 섹션 22.2 예시와 일치하는 키 목록, README/Docs에 로드 방법 명시.
  - 참조: 섹션 18(스프린트-0), 22.2, 10(보안 가드).
- **D-INF-03 데이터베이스 초기화**
  - 주요 작업: `sql/001_init.sql` 또는 Prisma 마이그레이션으로 섹션 15 DDL 적용, 로컬 Postgres `docker-compose` 연동.
  - 완료 조건: 마이그레이션 실행 스크립트(`pnpm migrate` 등) 제공, 최초 스키마 생성 검증.
  - 참조: 섹션 15, 22.1, 24.1~24.2.
- **D-INF-04 API 스켈레톤 & 헬스체크**
  - 주요 작업: NestJS 앱 부트스트랩, `/healthz`, `/version` 라우트, OpenAPI 스텁과 라우트 매핑.
  - 완료 조건: 스프린트-0 체크리스트(섹션 18) 충족, 최소 e2e 테스트.
  - 참조: 섹션 18, 19.3.
- **D-INF-05 거래소 HTTP 클라이언트**
  - 주요 작업: 서명/HMAC, 타임스탬프, 공통 헤더 처리 모듈(`exchange.service.ts`), 퍼블릭/서명 요청 헬퍼 분리.
  - 완료 조건: ExchangeDocs v2 매핑(섹션 6) 대응, 서명 단위 테스트 통과.
  - 참조: 섹션 6.1~6.5, 20.1.

## 2. API 게이트웨이 & 어드민 기능
- **D-API-01 API 키 관리 엔드포인트**
  - 주요 작업: `/user/accounts/keys` CRUD, `/test` 연결 검증, 키 암호화 저장.
  - 완료 조건: 성공/실패 케이스 응답 정의, 감사 로그 기록.
  - 참조: 섹션 4.2, 20.3, 10.
- **D-API-02 잔액 프록시**
  - 주요 작업: `/user/balances` → `GET /sapi/v1/account` 위임, 사용자별 권한 검사.
  - 완료 조건: Base/Quote 잔액, 수수료 정보 포함, 에러 코드 매핑.
  - 참조: 섹션 3.2(U2), 4.4, 6.4.
- **D-API-03 페어 메타 동기화**
  - 주요 작업: `PairsService.syncSymbols`, 주기적 잡 또는 수동 트리거, 토큰/페어 업서트.
  - 완료 조건: 정밀도·최소값 업데이트, 동기화 결과 메트릭.
  - 참조: 섹션 4.1, 20.2.
- **D-API-04 주문 프록시 & 검증**
  - 주요 작업: `/orders` POST/GET/DELETE, 정밀도·한도 검증(공유 유틸), 거래소 연동.
  - 완료 조건: 주문 전 검증 실패 시 명확한 오류코드, 성공 시 거래소 응답 전달.
  - 참조: 섹션 4.4, 6.3, 20.1.
- **D-API-05 일괄 취소 & 감사 로그**
  - 주요 작업: `/orders` DELETE(심볼별), `bot_events` 기록, 사용자 선택 옵션(즉시 취소/유지).
  - 완료 조건: 이벤트 저장, 감사 로그/알림 트리거.
  - 참조: 섹션 3.2(U4), 4.5, 20.5.
- **D-STR-01 전략 프로파일 관리**
  - 주요 작업: 전략 템플릿 CRUD, 사용자 복제/개인화, 파라미터 검증.
  - 완료 조건: 체결/매수/매도 별 파라미터 세트 저장, 활성화 상태 전환 시 검증.
  - 참조: 섹션 4.3, 9, 20.6.
- **D-DATA-01 감사/이력 기록 노출**
  - 주요 작업: 설정 변경, 키 열람, 주문 이벤트에 대한 API 제공.
  - 완료 조건: 사용자별 조회 가능, 필터(기간/이벤트 타입) 지원.
  - 참조: 섹션 3.2(U6), 4.5, 10.

## 3. 봇 런타임 & 전략 실행
- **D-BOT-01 WebSocket 게이트웨이**
  - 주요 작업: `/ws` 다중 구독, ticker/depth/myTrades 브로드캐스트, 재연결 로직.
  - 완료 조건: 연결 상태 모니터링, 레이트리밋 준수.
  - 참조: 섹션 4.4, 18(스프린트-2).
- **D-BOT-02 체결봇 MVP**
  - 주요 작업: 스프레드 임계치/IOC 전략 구현, 주문·체결 이벤트 핸들러.
  - 완료 조건: 상태 전환(RUNNING/PAUSED/HALTED) 및 이벤트 기록.
  - 참조: 섹션 3.1(A3), 4.4, 9.1.
- **D-BOT-03 매수·매도 봇 MVP**
  - 주요 작업: TP/SL, 기본 그리드/조건부 로직, DCA 관리.
  - 완료 조건: 전략 프로파일 연동, 라운딩·리스크 가드 통과.
  - 참조: 섹션 4.3, 9.2, 9.3.
- **D-BOT-04 런타임 리스크 가드**
  - 주요 작업: 한도 초과 차단, 수수료 고려 가격 계산, HALTED 원인 코드 관리.
  - 완료 조건: 한도 위반 시 주문 차단 + 이벤트 기록 + 알림.
  - 참조: 섹션 4.4(R-BOT-007/008), 4.5(R-MON-005), 10.
- **D-BOT-05 장애 복구 플로우**
  - 주요 작업: 재시작 시 오픈오더/포지션 재동기화, 재가동 사전 점검.
  - 완료 조건: 체크리스트 통과 후 RUNNING 전환, 실패 이유 반환.
  - 참조: 섹션 4.4(R-BOT-006/009), 4.5(R-MON-006).

## 4. 데이터 & 공통 모듈
- **D-DATA-02 Prisma/TypeORM 스키마 정합성**
  - 주요 작업: Prisma `schema.prisma` 또는 TypeORM 엔티티 구현, DDL과 동기화.
  - 완료 조건: 코드-DB 구조 일치, 자동 생성/검증 스크립트 제공.
  - 참조: 섹션 15, 24.2~24.4.
- **D-DATA-03 공통 유틸 패키지**
  - 주요 작업: 정밀도/라운딩(`precision.ts`), 레이트리밋, 타입 정의 공유.
  - 완료 조건: 게이트웨이/봇에서 동일 모듈 사용, 단위 테스트 포함.
  - 참조: 섹션 8, 19(패키지 구조), 20.1.
- **D-DATA-04 BotEvents & 로그 스키마**
  - 주요 작업: `bot_events` 테이블, 서비스 헬퍼, 상태 전환 기록 API.
  - 완료 조건: 이벤트 조회/필터 가능, 모니터링과 연계.
  - 참조: 섹션 4.5(R-MON-005), 20.5.

## 5. 모니터링 & 알림
- **D-MON-01 모니터링 대시보드 API**
  - 주요 작업: 봇 상태, 체결 수, 실패 수, 잔고, PnL 요약 API.
  - 완료 조건: 정규화된 응답 스키마, 프론트/대시보드 연동 문서.
  - 참조: 섹션 4.5(R-MON-001/003), 11.
- **D-MON-02 알림 통합**
  - 주요 작업: Slack/Telegram/Email 알림 어댑터, 임계치 정책.
  - 완료 조건: 이벤트 유형별 알림 라우팅, 재시도/써킷 브레이커.
  - 참조: 섹션 4.5(R-MON-002), 10.
- **D-MON-03 감사/감시 로그 파이프라인**
  - 주요 작업: 설정 변경/주문/키 열람 이벤트 수집, 저장, 조회 API.
  - 완료 조건: 감사 로그 보존 정책, 운영자 조회 UI/API.
  - 참조: 섹션 4.5(R-MON-004), 3.3.

## 6. 추세 목표(Equity Curve) 모듈
- **D-CURVE-01 곡선 생성기**
  - 주요 작업: 일일 상승/하강, 기간 곡선 생성 알고리즘, 스플라인 옵션.
  - 완료 조건: 입력 파라미터 검증, 시계열 데이터 반환.
  - 참조: 섹션 4.6(R-CURVE-001~004), 20.4.
- **D-CURVE-02 전략 연동 & 시각화 데이터**
  - 주요 작업: 곡선 vs 실측 비교, 주문 크기·빈도 조정 로직, API 응답 포맷.
  - 완료 조건: 목표/실측 시계열 제공, 조정 로직 단위 테스트.
  - 참조: 섹션 4.6(R-CURVE-005~007), 20.6.

## 7. 품질 보증 & 테스트
- **D-QA-01 레이트리밋/백오프 통합 테스트**
  - 주요 작업: 거래소 API 모킹, 재시도/백오프 시나리오 검증.
  - 완료 조건: 임계치 초과 시 지수 백오프 및 알림, CI 통합.
  - 참조: 섹션 18(품질 보증), 6.5.
- **D-QA-02 시그니처 검증 유닛 테스트**
  - 주요 작업: HMAC 생성/검증 경계값 테스트, 실패 케이스.
  - 완료 조건: 성공/실패 시 정합성 검증, 커버리지 보고.
  - 참조: 섹션 6.1, 18.
- **D-QA-03 라운딩/정밀도 경계 테스트**
  - 주요 작업: 가격/수량/금액 precision validation, 최소 주문값 테스트.
  - 완료 조건: 경계값(최소/최대) 케이스 통과, 공통 유틸과 연동.
  - 참조: 섹션 8, 18.
- **D-QA-04 장애 복구 시나리오 테스트**
  - 주요 작업: 봇 재시작, WS 끊김, HALTED 상태 재현.
  - 완료 조건: 재시작 전 체크리스트 검증, 로그/알림 확인.
  - 참조: 섹션 4.4(R-BOT-006~009), 10.

## 8. 운영 & 문서화
- **D-DOC-01 OpenAPI/DDL 스냅샷 파이프라인**
  - 주요 작업: `docs/_latest` 스냅샷 업데이트 스크립트, OpenAPI YAML 추출, DDL 내보내기.
  - 완료 조건: 릴리스마다 버전 태깅, 섹션 21 가이드 준수.
  - 참조: 섹션 18(스프린트-0), 21.1~21.4.
- **D-OPS-01 배포 및 운영 가이드**
  - 주요 작업: docker-compose, pm2/k8s 배포 옵션, 롤링 재배포 절차.
  - 완료 조건: 무중단 재배포 체크리스트, 헬스체크/모니터링 통합.
  - 참조: 섹션 11, 22.1, 23.
- **D-OPS-02 보안/리스크 운영 정책**
  - 주요 작업: 키 관리, 전역 중지 절차, 감사 정책 문서화.
  - 완료 조건: Admin/Operator 책임 경계 문서, 사고 대응 플레이북.
  - 참조: 섹션 3.5, 4.5, 10.

---

### 활용 가이드
1. 스프린트 계획 시 위 표의 ID를 백로그 항목으로 전환합니다.
2. 각 산출물 완료 시 근거 섹션의 요구사항 체크리스트를 함께 검증합니다.
3. 신규 요구사항이 추가되면 동일 포맷으로 ID를 확장하고 `docs/_latest/spec.md`와 동기화합니다.
